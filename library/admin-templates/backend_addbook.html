{% extends "backend.html" %}
{% block title %}Add Book{% endblock %}

{% block content %}	
<div class="mdl-grid">
	<div class="mdl-cell mdl-cell--12-col">
		<h2>Add Book</h2>
	</div>
	<div class="mdl-cell mdl-cell--12-col">
		<button id="show-dialog" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored">Add Book</button>
		<button id="show-dialog2" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" style="background-color:rgb(244,67,54);">Delete Selected</button>
		<button id="show-dialog3" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" style="background-color:#4caf50;">Add Catagory</button>
		<button id="show-dialog4" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" style="background-color:rgb(255, 152, 0);">Delete Catagory</button>
	</div>
	<div style="margin-left:20px;">
		<form action='/lib/librarian/backend_addbook/' class="well" method="post">
			{% csrf_token %}
			<label>Catagory</label>
				<select name="catagory_name">
					<option value="all">All</option>
					{% for catagory in catagories_list %}
	                <option value="{{catagory.name}}">{{catagory.name}}</option>
	                {% endfor %}
	        	</select>
	        <label style="margin-left:10px;">Status</label>
				<select name="status">
					<option value="all">All</option>
					<option value="AL">At Library</option>
	                <option value="BW">Borrowed</option>
	                <option value="DL">Deleted</option>
	        	</select>
	        <button type="submit" name="book_search" style="margin-left:10px;">Go!</button>
    	</form>
    </div>
	<div class="mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--11-col mdl-grid">
		<form id="bookform" action='/lib/librarian/backend_addbook/' method="post">
			{% csrf_token %}
			<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
			  <thead>
			    <tr>
			    	<th>#</th>
			    	<th class="mdl-data-table__cell--non-numeric">Code</th>
			    	<th class="mdl-data-table__cell--non-numeric">Title</th>
			    	<th class="mdl-data-table__cell--non-numeric">Author</th>
			    	<th class="mdl-data-table__cell--non-numeric">Catagories</th>
			    	<th class="mdl-data-table__cell--non-numeric">Status</th>
			    </tr>
			  </thead>
			  <tbody>
			  	{% for book in book_list %}
			    <tr name="bookTable" value="{{student.user.username}}" id="{{student.user.username}}">
			    	<td>
			    		<label class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect" for="checkbox-{{book.pk}}">
			    			<input name="bookTable" type="checkbox" id="checkbox-{{book.pk}}" value="checkbox-{{book.pk}}" class="mdl-checkbox__input">
			    		</label>
			    	</td>
			    	<td class="mdl-data-table__cell--non-numeric"><b>{{book.code}}</b></td>
			    	<td class="mdl-data-table__cell--non-numeric">{{book.name}}</td>
			    	<td class="mdl-data-table__cell--non-numeric">{{book.author}}</td>
			    	<td class="mdl-data-table__cell--non-numeric">{{book.catagory}}</td>
			    	{% if book.status == 'AL' %}
			    		<td class="mdl-data-table__cell--non-numeric">At Library</td>
			    	{% elif book.status == 'BW' %}
			    		<td class="mdl-data-table__cell--non-numeric">Borrowed</td>
			    	{% elif book.status == 'DL' %}
			    		<td class="mdl-data-table__cell--non-numeric">Deleted</td>
			    	{% endif %}
			    </tr>
			    {% endfor %}
			  </tbody>
			</table>
		</form>
	</div>
</div>

<dialog class="mdl-dialog" id="addBookDialog">
<h4 class="mdl-dialog__title">Add Book</h4>
<div class="mdl-dialog__content">
<!-- #########Form -->
	<form action='/lib/librarian/backend_addbook/' class="well" method="post" enctype="multipart/form-data">
		{% csrf_token %}

		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="add_name" class="mdl-textfield__label">Title</label>
			<input id="add_name" type="text" class="mdl-textfield__input" name="add_name" maxlength="100" required />
		</div>
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="add_author" class="mdl-textfield__label">Author</label>
			<input id="add_author" type="text" class="mdl-textfield__input" name="add_author" maxlength="100" required />
		</div>
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="add_code" class="mdl-textfield__label">Code</label>
			<input id="add_code" type="text" class="mdl-textfield__input" name="add_code" maxlength="100" required />
		</div>
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="add_date" class="mdl-textfield__label">Date Published</label>
			<input id="add_date" type="text" class="mdl-textfield__input" name="add_date" maxlength="100" />
		</div>
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="add_isbn" class="mdl-textfield__label">ISBN</label>
			<input id="add_isbn" type="text" class="mdl-textfield__input" name="add_isbn" maxlength="100" required />
		</div>
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="add_address" class="mdl-textfield__label">Address</label>
			<input id="add_address" type="text" class="mdl-textfield__input" name="add_address" maxlength="100" required />
		</div>
		<p>{{ form.non_field_errors }}</p>
			<p style="text-align: left; font-weight: bold;">{{ form.book_image.label_tag }} (Ex. book.png)
			{{ form.book_image.help_text }}
			</p>
			<p>{{ form.book_image.errors }} {{ form.book_image }} </p>
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label>Catagory</label>
			<select name="ab_catagory" id="ab_catagory" >
				{% for catagory in catagories_list %}
                <option value="{{catagory.name}}">{{catagory.name}}</option>
                {% endfor %}
        	</select>
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="mdl-button close">Close</button>
			<button type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent" name="add_book">Add</button>
		</div>
	</form>
<!-- #########Form -->
</div>
</dialog>


<dialog class="mdl-dialog" id="deleteBookDialog">
    <h4 class="mdl-dialog__title">Warning!</h4>
    <div class="mdl-dialog__content">
      <p>
        Are you really want to delete the selected book?
      </p>
    </div>
    <div class="mdl-dialog__actions">
		<button type="button" class="mdl-button close">No</button>
		<button type="submit" form="bookform" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" name="delete_book" style="background-color:rgb(244,67,54);">Yes!</button>
    </div>
 </dialog>

<dialog class="mdl-dialog" id="addCatagoryDialog">
<h4 class="mdl-dialog__title">Add New Catagory</h4>
<div class="mdl-dialog__content">
	<form action='/lib/librarian/backend_addbook/' class="well" method="post">
		{% csrf_token %}

		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label for="catagory_name" class="mdl-textfield__label">Name</label>
			<input id="catagory_name" type="text" class="mdl-textfield__input" name="catagory_name" maxlength="100" required />
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="mdl-button close">Close</button>
			<button type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent" name="add_catagory">Add</button>
		</div>
	</form>
</div>
</dialog>

<dialog class="mdl-dialog" id="deleteCatagoryDialog">
<h4 class="mdl-dialog__title">Delete Catagory</h4>
<div class="mdl-dialog__content">
	<form action='/lib/librarian/backend_addbook/' class="well" method="post">
		{% csrf_token %}
		<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label>Catagory</label>
			<select name="catagory_name" id="catagory_name" >
				{% for catagory in catagories_list %}
                <option value="{{catagory.name}}">{{catagory.name}}</option>
                {% endfor %}
        	</select>
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="mdl-button close">Close</button>
			<button type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent" name="delete_catagory">Delete</button>
		</div>
	</form>
</div>
</dialog>

{% endblock %}
{% block script %}
  <script>
    var dialog = document.querySelector('#addBookDialog');
    var showDialogButton = document.querySelector('#show-dialog');
    if (! dialog.showModal) {
      dialogPolyfill.registerDialog(dialog);
    }
    showDialogButton.addEventListener('click', function() {
      dialog.showModal();
    });
    dialog.querySelector('.close').addEventListener('click', function() {
      dialog.close();
    });

    var dialog2 = document.querySelector('#deleteBookDialog');
    var showDialogButton2 = document.querySelector('#show-dialog2');
    if (! dialog2.showModal) {
      dialogPolyfill.registerDialog(dialog2);
    }
    showDialogButton2.addEventListener('click', function() {
      dialog2.showModal();
    });
    dialog2.querySelector('.close').addEventListener('click', function() {
      dialog2.close();
    });

    var dialog3 = document.querySelector('#addCatagoryDialog');
    var showDialogButton3 = document.querySelector('#show-dialog3');
    if (! dialog3.showModal) {
      dialogPolyfill.registerDialog(dialog3);
    }
    showDialogButton3.addEventListener('click', function() {
      dialog3.showModal();
    });
    dialog3.querySelector('.close').addEventListener('click', function() {
      dialog3.close();
    });

    var dialog4 = document.querySelector('#deleteCatagoryDialog');
    var showDialogButton4 = document.querySelector('#show-dialog4');
    if (! dialog4.showModal) {
      dialogPolyfill.registerDialog(dialog4);
    }
    showDialogButton4.addEventListener('click', function() {
      dialog4.showModal();
    });
    dialog4.querySelector('.close').addEventListener('click', function() {
      dialog4.close();
    });
  </script>
{% endblock %}